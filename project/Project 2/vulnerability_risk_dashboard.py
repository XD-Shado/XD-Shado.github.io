import csv

# -----------------------------
# STEP 1: Define risk weights
# -----------------------------

SEVERITY_WEIGHTS = {
    "Low": 1,
    "Medium": 2,
    "High": 3
}

LIKELIHOOD_WEIGHTS = {
    "Low": 1,
    "Medium": 2,
    "High": 3
}

IMPACT_WEIGHTS = {
    "Low": 1,
    "Medium": 2,
    "High": 3
}

# -----------------------------
# STEP 2: Sample vulnerability data
# -----------------------------

vulnerabilities = [
    {
        "name": "SQL Injection",
        "type": "Injection",
        "severity": "High",
        "likelihood": "High",
        "impact": "High"
    },
    {
        "name": "Cross-Site Scripting (XSS)",
        "type": "Injection",
        "severity": "Medium",
        "likelihood": "High",
        "impact": "Medium"
    },
    {
        "name": "Weak Password Policy",
        "type": "Misconfiguration",
        "severity": "Medium",
        "likelihood": "Medium",
        "impact": "High"
    },
    {
        "name": "Outdated Software",
        "type": "Misconfiguration",
        "severity": "Low",
        "likelihood": "Medium",
        "impact": "Medium"
    },
    {
        "name": "Open Admin Panel",
        "type": "Access Control",
        "severity": "High",
        "likelihood": "Low",
        "impact": "High"
    }
]

# -----------------------------
# STEP 3: Calculate risk score
# Formula: Severity × Likelihood × Impact
# -----------------------------

for vuln in vulnerabilities:
    severity_score = SEVERITY_WEIGHTS[vuln["severity"]]
    likelihood_score = LIKELIHOOD_WEIGHTS[vuln["likelihood"]]
    impact_score = IMPACT_WEIGHTS[vuln["impact"]]

    vuln["risk_score"] = severity_score * likelihood_score * impact_score

# -----------------------------
# STEP 4: Sort vulnerabilities by risk score (highest first)
# -----------------------------

vulnerabilities.sort(key=lambda x: x["risk_score"], reverse=True)

# -----------------------------
# STEP 5: Export to CSV
# -----------------------------

with open("vulnerability_risk_dashboard.csv", "w", newline="") as file:
    writer = csv.writer(file)

    # Header row
    writer.writerow([
        "Vulnerability Name",
        "Type",
        "Severity",
        "Likelihood",
        "Impact",
        "Risk Score"
    ])

    # Data rows
    for vuln in vulnerabilities:
        writer.writerow([
            vuln["name"],
            vuln["type"],
            vuln["severity"],
            vuln["likelihood"],
            vuln["impact"],
            vuln["risk_score"]
        ])

print("Vulnerability Risk Dashboard created successfully.")
